<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>code-blox: js</title>
<style>
  /* MOBILE-FIRST APPROACH */
  :root {
    --neon: #facc15;
    --neon-glow: 0 0 10px rgba(250, 204, 21, 0.5);
    --panel: #000;
    --text: #fff;
    --muted: #000;
    color: var(--text);
    margin: 0;
    padding: 12px; /* Reduced padding for mobile */
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, monospace;
    -webkit-text-size-adjust: 100%;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* GRID - MOBILE FIRST */
  .grid {
    display: flex;
    flex-direction: column;
    gap: 20px;
    max-width: 100%;
    margin: auto;
  }
  
  /* TABLET */
  @media (min-width: 768px) {
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    body {
      padding: 16px;
    }
 : 1400px;
    }
  }
  
  /* PANELS */
  .panel {
    background: var(--panel);
    border: 2px solid rgba(250, 204, 21, 0.3); /* Thinner border for mobile */
    border-radius: 12px; /* Smaller radius */
    padding: 16px; /* Reduced padding */
    min-height: auto;
  }
  
  .panel h2 {
    margin: 0 0 12px;
    color: var(--neon);
    font-size: 18px; /* Smaller on mobile */
    font-weight: 600;
    border-bottom: 1px solid var(--neon);
    padding-bottom: 8px;
    word-break: break-word;
  }
  
  /* TEXTAREA - MOBILE OPTIMIZED */
  textarea {
    width: 100%;
    height: 200px; /* Shorter on mobile */
    background: rgba(0, 0, 0, 0.4);
    border: 1px solid var(--neon);
    border-radius: 8px;
    color: var(--text);
    padding: 12px;
    font: 14px -apple-system, system-ui, monospace;
    resize: vertical;
    outline: none;
    box-sizing: border-box;
    -webkit-appearance: none;
    font-size: 14px; /* Bigger for mobile typing */
    line-height: 1.4;
  }
  
  @media (min-width: 768px) {
    textarea {
      height: 340px;
      font-size: 13.5px;
      padding: 14px;
    }
  }
  
  textarea:focus {
    border-width: 2px;
    box-shadow: 0 0 8px rgba(250, 204, 21, 0.5);
  }
  
  /* BUTTONS - TOUCH-FRIENDLY */
  button {
    padding: 12px 16px; /* Bigger for touch */
    margin: 4px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    font-family: -apple-system, system-ui, sans-serif;
    transition: all 0.2s;
    font-size: 14px;
    min-height: 44px; /* Minimum touch target size */
    min-width: 44px;
  }
  
  /* BUTTON ROWS - STACK ON MOBILE */
  .btn-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin: 12px 0;
  }
  
  button.primary {
    background: var(--neon);
    color: #000;
    box-shadow: 0 2px 8px rgba(250, 204, 21, 0.5);
    flex: 1;
    min-width: 120px;
  }
  
  button.primary:hover, button.primary:active {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(250, 204, 21, 0.7);
  }
  
  button.success {
    background: #22c55e;
    color: #000;
    box-shadow: 0 2px 8px rgba(34, 197, 94px;
  }
  
  button.danger {
    background: #ef4444;
    color: #fff;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.5);
    flex: 1;
    min-width: 120px;
: 36px;
    min-width: 60px;
  }
  
  /* BLOCKS CONTAINER - SCROLLABLE */
  .blocks {
    max-height: 400px; /* Reduced for mobile */
    overflow-y: auto;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    gap: 12px;
    -webkit-overflow-scrolling: touch; /* Smooth iOS scroll */
  }
  
  @media (min-width: 768px) {
    .blocks {
      max-height: 760px;
      gap: 14px;
    }
  }
  
  /* INDIVIDUAL BLOCKS */
  .block {
    background: rgba(250, 204, 21, 0.1);
    border: 1px solid rgba(250, 204, 21, 0.5);
    border-radius: 8px;
    padding: 12px;
    position: relative;
    word-break: break-word;
  }
  
  .name {
    font-size: 15px;
    font-weight: 700;
    margin-bottom: 4px;
    cursor: text;
    color: var(--neon);
    line-height: 1.3;
  }
  
  .meta {
    font-size: 12px;
    color: var(--muted);
    margin: 6px 0;
    display: flex;
    font-weight: bold;
    color: var(--neon);
  }
  
  .builder-block {
    border-left: 4px solid #22c55e;
    background: rgba(34, 197, 94, 0.2);
  }
  
  .builder-block .name {
    colorpx;
    border-radius: 6px;
    overflow-x: auto;
    font-size: 11px;
    line-height: 1.3;
    margin-top: 8px;
    color: #fff;
    -webkit-overflow-scrolling: touch;
  }
  
  /* OUTPUT AREA */
  #output {
    background: #000;
    padding:-size: 12px;
    max-height: 300px; /* Smaller on mobile */
    overflow: auto;
    white-space: pre;
    color: #fff;
    -webkit-overflow-scrolling: touch;
  }
  
  @media (min-width: 768px) {
    #output {
      max-height: 560px;
      padding: 16px;
      font-size: .modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    z-index: 9999;
    padding: 16px;
    overflow: auto;
    display: none;
    -webkit-overflow-scrolling: touch;
  }
  
  .modal h2 {
    color: var(--neon);
    border-bottom: 1px solid var(--neon);
    padding-bottom: 8px;
    font-size: 18px;
    margin-top: 0;
  }
  
  .modal input {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    margin-bottom: 12px;
    background: rgba(0, 0, 0, 0.4);
    color: #fff;
    border: 1px solid var(--neon);
    border-radius: 8px;
    outline: none;
    box-sizing: border-box;
    -webkit-appearance: none;
  }
  
  .modal input:focus {
    border-width: 2px;
    box-shadow: 0 0 8px rgba(250, 204, 21, 0.5);
  }
  
  .modal textarea {
    height: calc(100vh - 200  /* UTILITY CLASSES FOR MOBILE */
  .mobile-only {
    display: block;
  }
  
  .desktop-only {
    display: none;
  }
  
  @media (min-width: 768px) {
    .mobile-only {
      display: none;
    }
    .desktop-only {
      display: block;
    }
  }
  
  /* SWIPE HINTS (FOR MOBILE UX) */
  .swipe-hint {
    display: none;
    text-align: center;
    font-size: 12px;
    color: var(--muted);
    padding: 8px;
    margin-top: 8px;
  }
  
  @media (max-width: 767px) {
    .swipe-hint {
      display: block;
    }
  }
  
  /* TOUCH-OPTIMIZED SCROLLBARS */
  :: 8px;
  }
  
  ::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
  }
  
  ::-webkit-scrollbar-thumb {
    background: var(--neon);
    border-radius: 4px;
  }
  
  ::-webkit-scroll    user-select: none;
    -webkit-user-select: none;
  }
  
  /* IMPROVE READABILITY ON SMALL SCREENS */
  @media (max-width: 767px) {
    .block pre {
      font-size: 10px;
      padding: 8px;
    }
    
    .meta button {
      margin: 2px;
    }
  }
</style>
</head>
<body>

<div class="grid">
  <!-- LEFT PANEL - INPUT -->
  <div class="panel">
    <h2>Paste Your JS</h2>
    <textarea id="input" placeholder="// Paste JS code here
// Or use the example below

function hello(name) {
  console.log('Hello ' + name);
  return name.length;
}

const calculate = (a, b) => {
  return a * b + 100;
};

class User {
  constructor(name) {
    this.name = name;
  }
  
  greet() {
    return `Hello ${this.name}`;
  }
}"></textarea>
    
    <div class="btn-row">
      <button class="primary" onclick="extract()">Extract Blocks</button>
      <button class="success" onclick="rebuildOriginal()">Rebuild</button>
      <button class="danger" onclick="location.reload()">Clear All</button>
    </div>
    
    <div class="mobile-only">
      <button class="small" onclick="pasteFromClipboard()">üìã Paste</button>
      <button class="small" onclick="loadExample()">üìñ Example</button>
    </div>

    <h2>Extracted Blocks</h2>
    <div class="swipe-hint">üëÜ Tap to edit names, swipe to scroll</div>
    <div id="blocks" class="blocks"></div>
  </div>

  <!-- RIGHT PANEL - BUILh2>
    <div class="btn-row">
      <button class="danger" onclick="builder=[];update()">Clear Builder</button>
      <button class="small mobile-only" onclick="toggleBuilderView()">üì± View</button>
    </div>
    
    <div class="swipe-hint">üëÜ Drag blocks from left, tap to reorder</div>
    <div id="builder" class="blocks" style="margin-top:8px;"></div>

    <h2 style="margin-top:20px;">Final Output</h2>
    <div class="btn-row">
      <button class="primary" onclick="copy()">üìã Copy</button>
      <button class="success" onclick="download()">üì• Download .js</button>
      <button class="small mobile-only" onclick="shareOutput()">üì§ Share</button>
    </div>
    
    <pre id="output"></pre>
  </div>
</div>

<!-- EDIT MODAL -->
<div id="editorModal" class="modal">
  <h2>Edit Block</h2>
  <input type="text" id="editName" placeholder="Block name (e.g., calculateUser)">
  <textarea id="editCode" placeholder="Edit your JavaScript code here..."></textarea>
  <div style="margin-top:12px; display: flex; gap: 8px;">
    <button class="success" onclick="saveEdit()" style="flex:1;">üíæ Save</button>
    <button class="danger" onclick="closeEditor()" style="flex:1;">‚ùå Cancel</button>
  </div>
</div>

<!-- MOBILE KEYBOARD HINT -->
<div id="keyboardHint" style="display:none; position:fixed; bottom: Tap here to close keyboard üëÜ
</div>

<script>
// MOBILE OPTIMIZATION FUNCTIONS
let originalBlocks = [];
let builder = [];
let editingIndex = -1;
let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

// Initialize with mobile optimizations
document.addEventListener('DOMContentLoaded UX
    document.querySelectorAll('.block').forEach(block => {
      block.addEventListener('touchstart', function(e) {
        this.style.transform = 'scale(0.98)';
      });
      
      block.addEventListener('touchend', function(e) {
        this.style.transform = 'scale(1)';
      });
    });
    
    // Handle keyboard show/hide
    const textareas = textarea.addEventListener('focus', function() {
        document.getElementById('keyboardHint').style.display = 'block';
      });
      
      textarea.addEventListener('blur', function() {
        document.getElementById('keyboardHint').style.display = 'none';
      });
    });
    
    // Close keyboard hint on tap
    document.getElementById('keyboardHintnone';
    });
  }
});

// MOBILE-ONLY FUNCTIONS
function pasteFromClipboard() {
  if (!navigator.clipboard) {
    alert("Clipboard not supported on this device");
    return;
  }
  
  navigator.clipboard.readText().then(text => {
    document.getElementById('input').value = text;
    showToast("‚úÖ Pasted from clipboard");
  }).catch(err => {
    alert("Could not paste. Try manual paste instead.");
  });
}

function loadExample() {
  const example = `// Example JavaScript with multiple blocks
function calculateTotal(items) {
  return items.reduce((sum, item) => sum + item.price, 0);
}

const user = {
  name: "Alex",
  age: 30,
  greet() {
    return \`Hello, my name is \${this.name}\`;
  }
  
  applyDiscount(percent) {
    this.price = this.price * (1 - percent/100);
    return this.price;
  }
}

// Arrow function example
const formatCurrency = (amount) => \`$\${amount.toFixed(2)}\`;

// Utility function
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    timeout = setTimeout(later, wait);
  };
}`;
  
  document.getElementById('input').value = example;
  showToast("üìñ Example loaded");
}

function shareOutput() {
  const output = document.getElementById('output').textContent;
  if (!output.trim()) {
    showToast("‚ùå No output to share");
    return;
 output.substring(0, 100) + '...',
      url: window.location.href
    });
  } else {
    copy();
  }
}

function toggleBuilderView() {
  const builderEl = document.getElementById('builder');
  const isCollapsed = builderEl.style.maxHeight === '200px';
  
  if (isCollapsed) {
    builderEl.style.maxHeight = '400px';
    builderElHeight = '200px';
    builderEl.style.overflow = 'hidden';
  }
}

// TOAST NOTIFICATIONS (MOBILE-FRIENDLY)
function showToast(message) {
  // Remove existing toast
  const existing = document.querySelector('.toast');
  if (existing) existing.remove();
  
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = message;
  toast.style.cssText = `
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #facc15;
    color: #000;
    padding: 12px 24px;
    border-radius: 8px;
    font-weight: bold;
    z-index: 10000;
    animation: fadeInOut  document.body.appendChild(toast);
  
  // Add CSS animation
  if (!document.querySelector('#toast-style')) {
    const style = document.createElement('style');
    style.id = 'toast-style';
    style.textContent = `
      @keyframes fadeInOut {
        0% { opacity: 0; bottom20px; }
        100% { opacity: 0; bottom: 40px; }
      }
    `;
    document.head.appendChild(style);
  }
  
  setTimeout(() => toast.remove(), 2000);
}

// ORIGINAL FUNCTIONS (OPTIMIZED FOR MOBILE)
function extract(){
  const code = document.getElementById('input').value.trim();
  if(!code) {
    showToast("‚ùå Paste code first");
    return;
  }

  originalBlocks = [];
  const lines = code.split('\n');
  let current = [], brace = 0, paren = 0;

  const finishBlock = () => {
    if(current.length === 0) return;
    const content = current.join('\n');
    if(!content.trim()) return;

    const nameMatch =
      content.match(/(function|const|let|var|class)\s+([A-Za-z_$][A-Za-z0-9_$]*)|([A-Za-z_$][A-Za-z0-9_$]*)\s*=/) || [];
    const name = nameMatch[2] || nameMatch[3] || "anonymous";

    originalBlocks.push({
      id: 'b' + Date.now() + Math.random(),
      name: name,
      content: content,
      lines: content.split('\n').length
    });
    current = [];
  };

  for(let line of lines){
    current.push(line);
    for(let ch of line){
      if(ch==='{') brace++;
      if(ch==='}') brace--;
      if(ch==='(') paren++;
      if(ch===')') paren--;
    }
    if(brace === 0 && paren <= 0 && current.length > 1) finishBlock();
  }
  finishBlock();

  if(originalBlocks.length === 0){
    originalBlocks.push({id:'full',name:'Full Script',content:Toast(`‚úÖ Extracted ${originalBlocks.length} blocks`);
}

function renderBlocks(){
  const blocksContainer = document.getElementById('blocks');
  if (!blocksContainer) return;
  
  blocksContainer.innerHTML = originalBlocks.map((b, i) => `
    <div class="block" data-id="${b.id}">
      <div class="name" contenteditable="true"
           onblur="originalBlocks[${i}].name=this.textContent.trim()||'anonymous'">
        ${b.name}
      </div>
      <div class="meta">
        <span class="lines">${b.lines} lines</span>
        <button class="small" onclick="editBlock(${i})">‚úèÔ∏è Edit</button>
        <button class="small" onclick="extractThis('${b.id}')">‚ûï Add</button>
      </div>
    </div>
  `).join('');
}

function editBlock(i){
  editingIndex = i;
  const block = originalBlocks[i];
  document.getElementById('editName').value = block.name;
  document.getElementById('editCode').value = block.content;
  document.getElementById('editorModal').style.display = 'block';
  
  // Focus the edit field on mobile
  if (isMobile) {
    setTimeout(() => {
      document.getElementById('editCode').focus();
    }, 100);
  }
}

function saveEdit(){
  if(editingIndex === -1) return;
  const block = originalBlocks[editingIndex];
  block.name = document.getElementById('editName').value.trim() || "anonymous";
  block.content = document.getElementById('editCode').value;
  block.lines = block.content.split('\n').length;
  closeEditor();
  renderBlocks();
  update();
  showToast("üíæ Changes saved");
}

function closeEditor(){
  document.getElementById('editorModal').style.display = 'none';
  editingIndex = -1;
  
  // Blur any active element
  if (document.activeElement) {
    document.activeElement.blur();
  }
}

function extractThis(id){
  const block = originalBlocks.find(b => b.id === id);
  if(block && !builder.find(b => bElementById('builder');
  const outputContainer = document.getElementById('output');
  
  if (!builderContainer || !outputContainer) return;
  
  builderContainer.innerHTML = builder.map((b, i) => `
    <div class="block builder-block">
      <div class="name">${b.name}</div>
      <div class="meta">
        <span class="lines">${b.lines} lines</span>
        <button class="danger small" onclick="builder.splice(${i},1);update();showToast('üóëÔ∏è Removed')">Remove</button>
      </div>
      <pre>${escapeHtml(b.content.trim())}</pre>
    </div>
  `).join('') || '<div style="color:#666;padding:20px;text-align:center;">No blocks in builder yet</div>';

  outputContainer.textContent =
    builder.map(b => b.content.trim()).join('\n\n') + (builder.length ? '\n' : '');
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

function rebuildOriginal(){
  builder = originalBlocks.map(b => ({...b}));
  update();
  showToast("üîÑ Original rebuilt");
}

function copy(){
  const text = document.getElementById('output').textContent;
  if (!text.trim()) {
    showToast("‚ùå Nothing to copy");
    return;
  }
  
  navigator.clipboard.writeText(text).then(() => {
    showToast("üìã Copied to clipboard!");
  }).catch(err => {
    // Fallback for older browsers
    const textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);
    showToast("üìã Copied!");
  });
}

function download(){
  constById('output').textContent;
  if (!text.trim()) {
    showToast("‚ùå Nothing to download");
    return;
  }
  
  const blob = new Blob([text], {type:'application/javascript'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'code-blox-output.js';
  a}

// Close modal when clicking outside (mobile-friendly)
document.getElementById('editorModal').addEventListener('click', function(e) {
  if (e.target === this) {
    closeEditor();
  }
});

// Prevent accidental page reload on mobile
window.addEventListener('beforeunload', function(e) {
  if (builder.length > 0 || document.getElementById(' e.returnValue = '';
  }
});

// Load a simple example on first visit
if (!localStorage.getItem('codeblox_visited')) {
  localStorage.setItem('codeblox_visited', 'true');
  setTimeout(loadExample, 500);
}
</script>
</body>
</html>